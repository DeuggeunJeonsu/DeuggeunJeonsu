<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="marketMapper">

    <!-- PRODCUT에 대한 resultMap -->
    <resultMap type="Product" id="product_rm">
        <id property="productNo" column="PRODUCT_NO"/>

        <result property="memberNo" column="MEMBER_NO"/>
        <result property="productName" column="PRODUCT_NAME"/>
        <result property="productPrice" column="PRODUCT_PRICE"/>
        <result property="productCount" column="PRODUCT_COUNT"/>
        <result property="boardCode" column="BOARD_CODE"/>
        <result property="productSt" column="PRODUCT_ST"/>
        <result property="productType" column="PRODUCT_TYPE"/>
        <result property="productContent" column="PRODUCT_CONTENT"/>
        <result property="productMaterial" column="PRODUCT_MATERIAL"/>
        <result property="productIntake" column="PRODUCT_INTAKE"/>
    </resultMap>

    <!-- BOARD에 대한 resultMap-->
    <resultMap type="Board" id="board_rm">
        <id property="boardNo" column="BOARD_NO"/>

        <result property="boardTitle" column="BOARD_TITLE"/>
        <result property="boardContent" column="BOARD_CONTENT"/>
        <result property="boardCreateDate" column="CREATE_DT"/>
        <result property="boardState" column="BOARD_ST"/>
        <result property="boardUpdateDate" column="UPDATE_DT"/>
        <result property="tagNo" column=""/>

        <result property="memberNo" column="MEMBER_NO"/>
        <result property="memberNickname" column="MEMBER_NICKNAME"/>
        <result property="profileImage" column="PROFILE_IMG"/>

    </resultMap>
    <!-- ProductImage에 대한 resultMap -->
    <resultMap type="ProductImage" id="productImage_rm">
        <id property="pImageNo" column="P_IMG_NO"/>
        <result property="pImagePath" column="P_IMG_PATH"/>
        <result property="productNo" column="PRODUCT_NO"/>
    </resultMap>

    <!-- 특정 게시판의 삭제되지 않은 게시글 수 조회 -->
    <select id="getListCount" resultType="_int">
        SELECT COUNT(*)
        FROM BOARD
        WHERE BOARD_DEL_FL = 'N'
          AND BOARD_CODE = #{boardCode}
    </select>

    <!-- 득근마켓 게시글 목록 조회 (검색X) -->
    <select id="selectMarketList" parameterType="map" resultMap="board_rm">
        SELECT BOARD_NO, BOARD_TITLE, BOARD_CONTENT, PRODUCT_NO
             , PRODUCT_NAME, PRODUCT_PRICE, PRODUCT_TYPE, PRODUCT_CONTENT
             , PRODUCT_MATERIAL, PRODUCT_INTAKE
        FROM BOARD
        JOIN PRODUCT USING (BOARD_CODE)
        WHERE PRODUCT_ST = 'Y'
          AND BOARD_CODE = #{boardCode}
        ORDER BY BOARD_NO DESC
    </select>


</mapper>
