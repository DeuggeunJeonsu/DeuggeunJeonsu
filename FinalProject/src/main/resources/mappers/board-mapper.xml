<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="boardMapper">


	<resultMap type="Board" id="board_rm">
		<id property="boardNo" column="BOARD_NO" />

		<result property="boardTitle" column="" />
		<result property="boardContent" column="" />
		<result property="boardCreateDate" column="" />
		<result property="boardState" column="" />
		<result property="boardUpdateDate" column="" />
		<result property="tagNo" column="" />

		<result property="memberNo" column="" />
		<result property="memberNickname" column="" />
		<result property="profileImage" column="" />
		<result property="thumbnail" column="" />

		<result property="commentCount" column="" />
		<result property="likeCount" column="" />

		<collection property="imageList" select="selectImageList"
			column="BOARD_NO" javaType="java.util.ArrayList" ofType="BoardImage">
		</collection>

		<collection property="commentList" select="selectImageList"
			column="BOARD_NO" javaType="java.util.ArrayList" ofType="Comment">
		</collection>

		<collection property="routineList" select="selectRoutineList" column="BOARD_NO" 
			javaType="java.util.ArrayList" ofType="Comment"> </collection> 
			

	</resultMap>
	
	
	<!-- 게시판 종류목록 조회 -->
	<select id="selectBoardTypeList" resultType="map">
		SELECT * FROM
		BOARD_TYPE ORDER BY 1
	</select>
	
	<!-- 자유게시판 게시글 삽입 -->
	<insert id="freeBoardInsert" parameterType="Board" useGeneratedKeys="true">
		<selectKey order="BEFORE" resultType="_int" keyProperty="boardNo">
			SELECT SEQ_BOARD_NO.NEXTVAL FROM DUAL
		</selectKey>		
		INSERT INTO BOARD
		VALUES(#{boardNo}, #{boardTitle}, #{boardContent},
				DEFAULT, DEFAULT, DEFAULT, DEFAULT,
				#{memberNo}, #{boardCode})
	</insert>
	
	<!-- 자유게시판 해시태그 삽입 -->
	<insert id="hashtagInsert" parameterType="Hashtag" useGeneratedKeys="true">
		<selectKey order="BEFORE" resultType="_int" keyProperty="tagNo">
			SELECT SEQ_TAG_NO.NEXTVAL FROM DUAL
		</selectKey>
		INSERT INTO HASHTAG
		VALUES(#{tagNo}, #{tagContent})
	</insert>
	
	<!-- 자유게시판 Board_hashtag 테이블 삽입 -->
	<insert id="boardHashtagInsert" parameterType="Hashtag">
		INSERT INTO BOARD_HASHTAG
		VALUES(#{boardNo}, #{tagNo})
	</insert>
	
	
	<!-- 공지사항 게시글 삽입 -->
	<insert id="ncInsert" useGeneratedKeys="true">
		<selectKey order="BEFORE" resultType="_int" keyProperty="boardNo">
			SELECT SEQ_BOARD_NO.NEXTVAL FROM DUAL
		</selectKey>
		INSERT INTO BOARD
		VALUES(#{boardNo}, #{boardTitle}, #{boardContent},
				DEFAULT, DEFAULT, DEFAULT, DEFAULT,
				#{memberNo}, #{boardCode})
		
	</insert>
	
	

</mapper>
